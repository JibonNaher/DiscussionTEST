<!DOCTYPE html>
<html>
<head>

  <link rel="stylesheet" type="text/css" href="./styles/exercise_style.css">
  

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
  <script src="./scripts/exercise_scripts.js"></script>

  <title>Discussion Page Test</title>
</head>
<body>
  
  <div id="main-content">
   <div id="topdesc">Dong-A Ilbo :</div>
    <div id="headline">Gender confrontation over extra points for military service</div>
    <div id="author-break"></div>
    </div>
    <br>
    <div id="headline-article-break"></div>
    <div class="article-text">
      Korea is likely to be divided into two over an issue. Recently, the Military Culture Reform Committee, a private, public and military joint organization, proposed a recommendation to give extra points for compensation to those who completed military service. It seems quite natural that a heated controversy is caused over this recommendation.<br>
      <br>
      The military service is imposed only to men among four duties of a citizen. Since the military service is mandatory for men but optional for women, controversy over gender equality starts from here.<br>
      <br>
      After exhausted 2 years in the military camp, those young men end up with a gap in their education and preparation for employment. As long as there is no change in the current conscription system, people who sacrificed their youth for nation must not be put at a disadvantage, if not compensated properly.
 </div>
    <div id="article-voting" class="secondary-interactions">
      <button class="response-button" onclick="buttonClicked('downvote', this);" type="button"> <img id="downvote-article-icon-1" class="button-icon" src='./resources/downvote.png'> Downvote </button>
      <button class="response-button" onclick="buttonClicked('upvote', this);" type="button"> <img id="upvote-article-icon-1" class="button-icon" src='./resources/upvote.png'> Upvote </button>
    </div>
  
  <div id="article-break"> </div>

  <div id="comment-section">
    <div id="comment-header">Comments</div>
    <br>
    <div id="comment1" class="comment-box"> 
     <div class="comment-username">User 2647   <a>(35 minutes ago)</a></div>
      <div class="comment-text">Stop discriminating against women and the disabled. We have to consider the both sides of the argument and reorganize the program</div>
      <div class="comment-interactions secondary-interactions">
        <!-- <button id="reply-button-1" class="response-button reply-button" onclick="buttonClicked('reply', this)">Reply</button> -->
        <button id="downvote-button-1" class="response-button" onclick="buttonClicked('downvote', this);"> 
          <img id="downvote-comment-icon-1" class="button-icon" src='./resources/downvote.png'> Downvote</button>
        <button id="upvote-button-1" class="response-button" onclick="buttonClicked('upvote', this);"> 
          <img id="upvote-comment-icon-1" class="button-icon" src='./resources/upvote.png'>Upvote</button>
        <button id="report-button-1" class="response-button" onclick="buttonClicked('report', this);">
          <img id="report-icon-1" class="button-icon" src="./resources/flag.png">Report</button>
      </div>
      <div id="reply-area-1" class="comment-reply reply-button reply-area">
        <textarea id="reply-textarea-1" placeholder="Join a discussion" class="reply-textarea"></textarea>
        <button id="reply-submit-button-1" class="response-button reply-button main-button reply-submit-button" onclick="buttonClicked('reply-submit', this)">Reply</button>
      </div>
      
      <div class="user-comment-spacer"></div>
    </div>
    
    <div id="comment2" class="comment-box"> 
      <div class="comment-username">User 1892   <a>(27 minutes ago)</a></div>
     <div class="comment-text">Men are house-keeping dogs. It doesn't make sense to feed more because they did what they were supposed to do.</div>
      <div class="comment-interactions secondary-interactions">
        <!-- <button id="reply-button-2" class="response-button reply-button" onclick="buttonClicked('reply', this)">Reply</button> -->
        <button id="downvote-button-2" class="response-button" onclick="buttonClicked('downvote', this);"> 
          <img id="downvote-comment-icon-2" class="button-icon" src='./resources/downvote.png'> Downvote</button>
        <button id="upvote-button-2" class="response-button" onclick="buttonClicked('upvote', this);"> 
          <img id="upvote-comment-icon-2" class="button-icon" src='./resources/upvote.png'> Upvote</button>
        <button id="report-button-2" class="response-button" onclick="buttonClicked('report', this);">
          <img id="report-icon-2" class="button-icon" src="./resources/flag.png">Report</button>
        
      </div>
      <div id="reply-area-2" class="comment-reply reply-button reply-area">
        <textarea id="reply-textarea-2" placeholder="Join a discussion" class="reply-textarea"></textarea>
        <button id="reply-submit-button-2" class="response-button reply-button main-button reply-submit-button" onclick="buttonClicked('reply-submit', this)">Reply</button>
      </div>
      
      <div class="user-comment-spacer"></div>
    </div>
    
    <div id="comment3" class="comment-box"> 
      <div class="comment-username">User 3018   <a>(18 minutes ago)</a></div>
     <div class="comment-text">You idiots... It is unworthy to force men to do their duty without any benefit.</div>
      <div class="comment-interactions secondary-interactions">
        <!-- <button id="reply-button-3" class="response-button reply-button" onclick="buttonClicked('reply', this)">Reply</button> -->
        <button id="downvote-button-3" class="response-button" onclick="buttonClicked('downvote', this);"> 
          <img id="downvote-comment-icon-3" class="button-icon" src='./resources/downvote.png'> Downvote</button>
        <button id="upvote-button-3" class="response-button" onclick="buttonClicked('upvote', this);"> 
          <img id="upvote-comment-icon-3" class="button-icon" src='./resources/upvote.png'> Upvote</button>
        <button id="report-button-3" class="response-button" onclick="buttonClicked('report', this);">
          <img id="report-icon-1" class="button-icon" src="./resources/flag.png">Report</button>
        
      </div>
      <div id="reply-area-3" class="comment-reply reply-button reply-area">
        <textarea id="reply-textarea-3" placeholder="Join a discussion" class="reply-textarea"></textarea>
        <button id="reply-submit-button-3" class="response-button reply-button main-button reply-submit-button" onclick="buttonClicked('reply-submit', this)">Reply</button>
      </div>
      <div class="user-comment-spacer"></div>
    </div>
    
    <div id="comment4" class="comment-box"> 
     <div class="comment-username">User 5472   <a>(7 minutes ago)</a></div>
      <div class="comment-text">Calm down. What most people say is that the benefits should be given, but the method is wrong.</div>
      <div class="comment-interactions secondary-interactions">
        <!-- <button id="reply-button-4" class="response-button reply-button" onclick="buttonClicked('reply', this)">Reply</button> -->
        <button id="downvote-button-4" class="response-button" onclick="buttonClicked('downvote', this);"> 
          <img id="downvote-comment-icon-4" class="button-icon" src='./resources/downvote.png'> Downvote</button>
        <button id="upvote-button-4" class="response-button" onclick="buttonClicked('upvote', this);"> 
          <img id="upvote-comment-icon-4" class="button-icon" src='./resources/upvote.png'> Upvote</button>
        <button id="report-button-4" class="response-button" onclick="buttonClicked('report', this);">
          <img id="report-icon-1" class="button-icon" src="./resources/flag.png">Report</button>

      </div>
      <div id="reply-area-4" class="comment-reply reply-button reply-area">
        <textarea id="reply-textarea-4" placeholder="Join a discussion" class="reply-textarea"></textarea>
        <button id="reply-submit-button-4" class="response-button reply-button main-button reply-submit-button" onclick="buttonClicked('reply-submit', this)">Reply</button>
      </div>
      
      <div class="user-comment-spacer"></div>
    </div>
    
    
  </div>
  
  <div id="comment-section-break"></div>
  
  <div id="comment-submission">
    <div id="comment-submission-title"><img id="comment-submission-icon" src="./resources/commentBubble.png"> Comment</div>
  </div>
  
  <div class="w3-light-grey">
    <div id="scorebar-comment" class="w3-container w3-center" style="width:25%"> </div>
  </div>
  <div id="comment-area-1" class="comment-reply reply-button">
    <textarea id="comment-textarea" placeholder="Join the discussion" class="reply-textarea"></textarea>
    <button id="comment-submit-button-1" class="response-button reply-button main-button reply-submit-button" onclick="buttonClicked('comment-submit', this)">Comment</button>
  </div>
  
  <script>

    var score;
    $("#comment-textarea").keyup(()=>{
        const analyzeURL = 'https://commentanalyzer.googleapis.com/v1alpha1/comments:analyze?key=AIzaSyAXBN-B4-kxdC0wG9IJWaLNDonVIY_Ei8M';
        const x = new XMLHttpRequest();
        var msg = $("#comment-textarea").val() || ".";

        const composedComment = `{comment: {text: "${msg}"},
            languages: ["en"],
            requestedAttributes: {TOXICITY:{}} }`;
        x.open('POST', analyzeURL, true);
        x.setRequestHeader('Content-Type', 'application/json');
        x.responseType = 'json';
        x.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                score = this.response.attributeScores.TOXICITY.summaryScore.value;
                console.log(score);
                // $("#comment-textarea").val() ? $('#scorebar-comment').val(1-score) : $('#scorebar-comment').val(0);
                $("#comment-textarea").val() ? $('#scorebar-comment').width(((1-score)*100)+"%")&&$('#scorebar-comment').html("Civility Score : "+parseInt((1-score)*100)) : $('#scorebar-comment').width(0)&&$('#scorebar-comment').html("");
                if (1-score < 0.4) {
                  $('#scorebar-comment').css('backgroundColor', '#ef5350'); 
                  $("#comment-textarea").val() ? $('#scorebar-comment').width(((1-score)*100)+"%")&&$('#scorebar-comment').html(parseInt((1-score)*100)) : $('#scorebar-comment').width(0)&&$('#scorebar-comment').html("");
                } else if (1-score < 0.7) $('#scorebar-comment').css('backgroundColor', '#ffb74d');
                else $('#scorebar-comment').css('backgroundColor', '#3798d9');
            };
        };
      x.send(composedComment);
    });

  </script>
</body>
</html> 
